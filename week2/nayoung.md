# 1ì£¼ì°¨

ë²”ìœ„: 1-3ì¥

# Ch1. Kafka ì‹œì‘í•˜ê¸°

MSA ì ìš© í”„ë¡œì íŠ¸ê°€ ëŠ˜ì–´ë‚¨ì— ë”°ë¼, Kafka ì ìš©ë„ ì¦ê°€í•˜ê³  ìˆë‹¤.
![image](https://github.com/user-attachments/assets/79edce5a-24e7-4427-80e3-b3be2769643a)


## ğŸŒ³ Kafkaë€ ë¬´ì—‡ì¸ê°€?

- pub/sub ë©”ì‹œì§€ ì „ë‹¬ ì‹œìŠ¤í…œ
- ë©”ì‹œì§€ íë¥¼ ê´€ë¦¬í•˜ë©°, ë¸Œë¡œì»¤ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë°œìƒìì™€ êµ¬ë…ì ê°„ì— ì¤‘ê³„
- ë°ì´í„° ìƒì„±ê³¼ ì²˜ë¦¬ë¥¼ ë¶„ë¦¬í•˜ê³  íš¨ìœ¨ì ì„ ìœ ì—°í•˜ê²Œ ê´€ë¦¬

### ğŸŒ¿ Pub/Sub ë©”ì‹œì§•ì˜ í•„ìš”ì„±

- ì „í†µì ì¸ ë°©ì‹ì€ ë°œí–‰ìì™€ êµ¬ë…ìê°€ ì§ì ‘ ì—°ê²°ë˜ì–´ ìœ ì§€ë³´ìˆ˜ ë¹„ìš©ì´ ë†’ê³ , í™•ì¥ì„±ì´ ë‚®ë‹¤.
- ë°œí–‰/êµ¬ë… ëª¨ë¸ì€ ë°ì´í„° íë¦„ì„ ì¤‘ì•™ ì§‘ì¤‘í™”í•˜ì—¬ íš¨ìœ¨ì„±ê³¼ í™•ì¥ì„±ì„ ë†’ì„
- KafkaëŠ” ë°œí–‰/êµ¬ë… ëª¨ë¸ì„ íš¨ê³¼ì ìœ¼ë¡œ êµ¬í˜„í•´ ì•ˆì •ì„±ê³¼ ì„±ëŠ¥ì„ ì œê³µ
    - ë°ì´í„°ë¥¼ ìˆœì„œëŒ€ë¡œ ì§€ì†ì ìœ¼ë¡œ ì €ì¥
    - ë°ì´í„°ë¥¼ ë¶„ì‚° ì €ì¥í•˜ì—¬ ì¥ì•  ë³´í˜¸ì™€ ì„±ëŠ¥ í™•ì¥ ê°€ëŠ¥

## ğŸŒ³ Kafkaì˜ ì£¼ìš” ê°œë…

![image](https://github.com/user-attachments/assets/caa736d1-e5f0-43dc-b9a3-932d7a7d39cd)

### ğŸŒ¿ ë©”ì‹œì§€ì™€ ë°°ì¹˜

- Kafkaì˜ ê¸°ë³¸ ëŒ€ì•„í†  ë‹¨ìœ„ëŠ” ë©”ì‹œì§€(message)
- ë©”ì‹œì§€ëŠ” í‚¤(key)ì™€ ê°’(value)ë¡œ êµ¬ì„±ë˜ë©°, íš¨ìœ¨ì ì¸ ì²˜ë¦¬ë¥¼ ìœ„í•´ ë©”ì‹œì§€ë¥¼ ë°°ì¹˜(batch) ë‹¨ìœ„ë¡œ, í•œ ë²ˆì— ë¬¶ì–´ì„œ ì „ì†¡
- ë°°ì¹˜ ì²˜ë¦¬ëŠ” ë„¤íŠ¸ì›Œí¬ I/Oë¥¼ ì¤„ì´ê³  ì²˜ë¦¬ íš¨ìœ¨ì„ ë†’ì„

### ğŸŒ¿ í† í”½ê³¼ íŒŒí‹°ì…˜

- í† í”½(Topic) : ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì„ ë‚˜íƒ€ë‚´ëŠ” ë…¼ë¦¬ì  ë‹¨ìœ„
    
    > Topicì€ Partitionìœ¼ë¡œ êµ¬ì„±ëœ ì¼ë ¨ì˜ **ë¡œê·¸** íŒŒì¼
    > 
    > 
    > ![image](https://github.com/user-attachments/assets/eb2006c7-5899-4239-b6cf-87f6a9059e1b)

    > 
    - RDBMSì˜ Tableê³¼ ìœ ì‚¬í•œ ê¸°ëŠ¥
    - Topicì€ Keyì™€ Value ê¸°ë°˜ì˜ ë©”ì‹œì§€ êµ¬ì¡°ì´ë©°, Valueë¡œ ì–´ë–¤ íƒ€ì…ì˜ ë©”ì‹œì§€ë„ ê°€ëŠ¥(ë¬¸ìì—´, ìˆ«ìê°’, ê°ì²´, Json, Avro, Protobuf ë“±)
    - Topicì€ ì‹œê°„ì˜ íë¦„ì— ë”°ë¼ ë©”ì‹œì§€ê°€ **ìˆœì°¨ì ìœ¼ë¡œ** ë¬¼ë¦¬ì ì¸ íŒŒì¼ì— writeëœë‹¤.
- íŒŒí‹°ì…˜(Partition) : ë¬¼ë¦¬ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë‹¨ìœ„(í•˜ë‚˜ì˜ í° í† í”½ì„ ì—¬ëŸ¬ ê°œì˜ ì‘ì€ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆˆ ê²ƒ)
    
    > Partitionì€ Kafkaì˜ **ë³‘ë ¬ ì„±ëŠ¥ê³¼ ê°€ìš©ì„± ê¸°ëŠ¥ì˜ í•µì‹¬ ìš”ì†Œ**ì´ë©°, ë©”ì‹œì§€ëŠ” ë³‘ë ¬ ì„±ëŠ¥ê³¼ ê°€ìš©ì„±ì„ ê³ ë ¤í•œ ê°œë³„ íŒŒí‹°ì…˜ì— ë¶„ì‚° ì €ì¥ëœë‹¤.
    > 
    - ê°œë³„ íŒŒí‹°ì…˜ì€ ì •ë ¬ë˜ê³ , ë³€ê²½ í•  ìˆ˜ ì—†ëŠ”(immutable) ì¼ë ¨ì˜ ë ˆì½”ë“œë¡œ êµ¬ì„±ëœ ë¡œê·¸ ë©”ì‹œì§€
    - ê°œë³„ ë ˆì½”ë“œëŠ” `offset`ìœ¼ë¡œ ë¶ˆë¦¬ëŠ” ì¼ë ¨ ë²ˆí˜¸ë¥¼ í• ë‹¹ ë°›ìŒ
    - íŒŒí‹°ì…˜ ë‚´ì—ì„œëŠ” ë©”ì‹œì§€ ìˆœì„œ ë³´ì¥
    - í† í”½ ì „ì²´ì—ì„œëŠ” ìˆœì„œ ë³´ì¥í•˜ì§€ ì•ŠìŒ
- íŒŒí‹°ì…˜ì€ ì—¬ëŸ¬ ì„œë²„ì— ë¶„ì‚° ì €ì¥ë˜ì–´ í™•ì¥ì„±ê³¼ ê°€ìš©ì„±ì„ ì œê³µ (ë³µì œë„ íŒŒí‹°ì…˜ ë‹¨ìœ„ë¡œ ì´ë£¨ì–´ì§)
- ì•„ë˜ëŠ” `replication-factor=2` ì˜ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì´ë‹¤.
    - ê° íŒŒí‹°ì…˜ì€ 2ê°œì˜ ë¸Œë¡œì»¤ì— ì €ì¥ëœë‹¤. (ì›ë³¸ 1ê°œ + ë³µì œë³¸ 1ê°œ)
    - ProducerëŠ” ë©”ì‹œì§€ë¥¼ Leaderë¡œë§Œ ë³´ë‚´ê³ , FollowerëŠ” ê·¸ê±¸ ë³µì œí•œë‹¤. ê·¸ë¦¬ê³  Leaderì˜ Brokerê°€ ë§ê°€ì¡Œì„ ë•Œ, Follwerê°€ Leaderê°€ ëœë‹¤.
    - í•œ ê°œì˜ ë¸Œë¡œì»¤ê°€ ì‹¤íŒ¨í•´ë„ ë°ì´í„°ë¥¼ ìƒì§€ ì•ŠëŠ”ë‹¤.
    - â€» replication-factor ìˆ˜ ì´ìƒì˜ brokerê°€ ìˆì–´ì•¼ í•œë‹¤.

![image](https://github.com/user-attachments/assets/48139638-58f4-406d-9ef5-7490d85d63b5)


### ğŸŒ¿ ìƒì‚°ì(Producer)

- ë©”ì‹œì§€ë¥¼ ìƒì„±í•´ íŠ¹ì • í† í”½ì— ê¸°ë¡
- íŒŒí‹°ì…”ë„ˆ(partitioner)ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ íŒŒí‹°ì…˜ì— ë¶„ë°°
    - í‚¤ ê°’ì„ í•´ì‹±í•´ íŠ¹ì • íŒŒí‹°ì…˜ì— ë§¤í•‘ê°€ëŠ¥
    - ë™ì¼ í‚¤ ê°’ì„ ê°€ì§„ ë©”ì‹œì§€ëŠ” ê°™ì€ íŒŒí‹°ì…˜ì— ì €ì¥ë¼ ìˆœì„œ ë³´ì¥
- ì»¤ìŠ¤í…€ íŒŒí‹°ì…”ë„ˆë¥¼ êµ¬í˜„í•´ ë°ì´í„° ë¶„ë°° ë°©ì‹ ë³€ê²½ ê°€ëŠ¥
- ProducerëŠ” ì„±ëŠ¥/ë¡œë“œë°¸ëŸ°ì‹±/ê°€ìš©ì„±/ì—…ë¬´ ì •í•©ì„±ë“±ì„ ê³ ë ¤í•˜ì—¬ ì–´ë–¤ ë¸Œë¡œì»¤ì˜ íŒŒí‹°ì…˜ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì•¼ í• ì§€ **ì „ëµì **ìœ¼ë¡œ ê²°ì •ë¨

### ğŸŒ¿ ì†Œë¹„ì(Consumer)

- ë©”ì‹œì§€ë¥¼ ì½ê³  ì²˜ë¦¬í•˜ëŠ” ì—­í• 
- ë©”ì‹œì§€ë¥¼ ì½ì–´ê°€ë”ë¼ë„, ì—¬ì „íˆ ë©”ì‹œì§€ëŠ” ë³´ì¡´ë˜ì–´ ìˆë‹¤.
- í•˜ë‚˜ ì´ìƒì˜ í† í”½ì„ êµ¬ë…í•˜ì—¬ ë°ì´í„°ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ê°€ì ¸ì˜´
- ì˜¤í”„ì…‹(offset)ì„ ê¸°ë¡í•´ ì½ì€ ìœ„ì¹˜ë¥¼ ê´€ë¦¬
    - ìë™ ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ ì˜¤í”„ì…‹ ê´€ë¦¬ ê°€ëŠ¥
    - í•„ìš” ì‹œ ì´ì „ ì˜¤í”„ì…‹ìœ¼ë¡œ ì´ë™í•´ ë©”ì‹œì§€ ì¬ì²˜ë¦¬ ê°€ëŠ¥
- ì—¬ëŸ¬ ê°œì˜ Consumerë“¤ë¡œ êµ¬ì„±ë  ê²½ìš° ì–´ë–¤ ë¸Œë¡œì»¤ì˜ íŒŒí‹°ì…˜ì—ì„œ ë©”ì‹œì§€ë¥¼ ì½ì–´ë“¤ì¼ì§€ **ì „ëµì **ìœ¼ë¡œ ê²°ì •í•¨

### ğŸŒ¿ ë¸Œë¡œì»¤(Broker)ì™€ í´ëŸ¬ìŠ¤í„°(Cluster)

- **ë¸Œë¡œì»¤**: ë©”ì‹œì§€ë¥¼ ë³´ê´€í•˜ê³  ê´€ë¦¬í•˜ëŠ” Kafka ì„œë²„
    
    > í•™êµ ë„ì„œê´€ì˜ ì‚¬ì„œ ì„ ìƒë‹˜ê³¼ ë¹„ìŠ·í•˜ê²Œ, ì±…(ë©”ì‹œì§€)ë¥¼ ë°›ì•„ì„œ, ì ì ˆí•œ ì±…ì¥(í† í”½)ì— ë¶„ë¥˜í•˜ê³  ì •ë¦¬í•´ë‘ì—ˆë‹¤ê°€, ëˆ„êµ°ê°€ í•„ìš”í•  ë•Œ ì°¾ì•„ì„œ ë¹Œë ¤ì¤€ë‹¤. ë¸Œë¡œì»¤ëŠ” ë„ì„œê´€ ê±´ë¬¼!
    > 
- **í´ëŸ¬ìŠ¤í„°**: ì—¬ëŸ¬ ë¸Œë¡œì»¤ë¡œ êµ¬ì„±ëœ ì¹´í”„ì¹´ ë‹¨ìœ„(ì—¬ëŸ¬ ë¸Œë¡œì»¤ê°€ í•¨ê»˜ ì¼í•˜ëŠ” ê·¸ë£¹)
    
    > í•˜ë‚˜ì˜ í° í•™êµì— ì—¬ëŸ¬ ë„ì„œê´€ì´ ìˆê³ , ê° ë„ì„œê´€ë§ˆë‹¤ ì‚¬ì„œ ì„ ìƒë‹˜ë“¤ì´ í˜‘ë ¥í•´ì„œ ì¼í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤. ë§Œì•½ í•œ ë„ì„œê´€(ë¸Œë¡œì»¤)ì— ë¬¸ì œê°€ ìƒê²¨ë„ ë‹¤ë¥¸ ë„ì„œê´€ì´ ëŒ€ì‹  ì±…ì„ ë¹Œë ¤ì¤„ ìˆ˜ ìˆì–´ì„œ í•­ìƒ ì„œë¹„ìŠ¤ê°€ ìœ ì§€ëœë‹¤. ë˜í•œ í•™ìƒì´ ë§ì•„ì§€ë©´(ë°ì´í„°ê°€ ì¦ê°€í•˜ë©´) ë„ì„œê´€ì„ ë” ì§€ì–´ì„œ(ë¸Œë¡œì»¤ ì¶”ê°€) ëŒ€ì‘í•  ìˆ˜ ìˆë‹¤.
    > 
    - **ì»¨íŠ¸ë¡¤ëŸ¬ ë¸Œë¡œì»¤**: íŒŒí‹°ì…˜ í• ë‹¹ê³¼ ë¸Œë¡œì»¤ ê´€ë¦¬ ë‹´ë‹¹
    - **íŒŒí‹°ì…˜ ë¦¬ë”**: íŒŒí‹°ì…˜ ë°ì´í„°ë¥¼ ì½ê³  ì“°ëŠ” ì‘ì—… ì²˜ë¦¬
    - **íŒ”ë¡œì›Œ**: ë¦¬ë” ë°ì´í„°ë¥¼ ë³µì œí•´ ì¥ì•  ë°œìƒ ì‹œ ë¦¬ë” ì—­í•  ìˆ˜í–‰
- ë¦¬ë”-íŒ”ë¡œì›Œ êµ¬ì¡°ë¥¼ í†µí•´ ë°ì´í„° ë³µêµ¬ ë° ê°€ìš©ì„± í™•ë³´

## ğŸŒ³ Kafkaì˜ ì£¼ìš” íŠ¹ì§• ë° ì¥ì 

- **ë‹¤ì¤‘ í”„ë¡œë“€ì„œ ë° ì»¨ìŠˆë¨¸ ì§€ì›**
    - ì—¬ëŸ¬ í”„ë¡œë“€ì„œì™€ ì»¨ìŠˆë¨¸ë¥¼ ë™ì‹œì— ì§€ì›
    - ì»¨ìŠˆë¨¸ ê·¸ë£¹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥
- **ë†’ì€ í™•ì¥ì„±**
    - ë¸Œë¡œì»¤ ì¶”ê°€ ë° íŒŒí‹°ì…˜ ë¶„ë°°ë¡œ ì²˜ë¦¬ëŸ‰ í™•ì¥ ê°€ëŠ¥
- **ë””ìŠ¤í¬ ê¸°ë°˜ ë°ì´í„° ë³´ì¡´**
    - ë°ì´í„°ë¥¼ ì§€ì†ì ìœ¼ë¡œ ì €ì¥í•˜ì—¬ ì¥ì•  ìƒí™©ì—ì„œë„ ë°ì´í„° ë³µêµ¬ ê°€ëŠ¥

## ğŸŒ³ Kafkaì˜ ì—­ì‚¬

- LinkedInì—ì„œ ê°œë°œ
- ì²˜ìŒì—ëŠ” ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§ê³¼ ì‚¬ìš©ì í™œë™ ì¶”ì  ì‹œìŠ¤í…œì˜ ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ì„¤ê³„
- 2010ë…„ ì˜¤í”ˆì†ŒìŠ¤ë¡œ ê³µê°œ, 2012ë…„ Apache í”„ë¡œì íŠ¸ë¡œ ìŠ¹ê²©
- í˜„ì¬ Netflix, Uber ë“± ë§ì€ ê¸°ì—…ì˜ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì— ì‚¬ìš©ë¨

# Ch2. Kafka ì„¤ì¹˜í•˜ê¸°

> ì‹¤ìŠµì€ ì•„ë˜ ê°•ì˜ í•¸ì¦ˆì˜¨ìœ¼ë¡œ ëŒ€ì²´
> 
- KafkaëŠ” í´ëŸ¬ìŠ¤í„°ì™€ consumer í´ë¼ì´ì–¸íŠ¸ ì„¸ë¶€ ì •ë³´ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ Zookeeperë¥¼ ì‚¬ìš©í•œë‹¤.
- ZookeeperëŠ” êµ¬ì„± ì •ë³´ ìœ ì§€, ì´ë¦„ ì§€ì •, ë¶„ì‚° ë™ê¸°í™” ë° ê·¸ë£¹ ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•œ ì¤‘ì•™ ì§‘ì¤‘ì‹ ì„œë¹„ìŠ¤ì´ë‹¤.

## ğŸŒ³ Broker êµ¬ì„±í•˜ê¸°

### ğŸŒ¿ broker.id

- ë¸Œë¡œì»¤ë¥¼ ì‹ë³„í•˜ëŠ” ê³ ìœ  ì •ìˆ˜ ê°’
- í´ëŸ¬ìŠ¤í„° ë‚´ [`broker.id`](http://broker.id) ëŠ” ì¤‘ë³µ ë¶ˆê°€

### ğŸŒ¿ listeners

- ë¸Œë¡œì»¤ê°€ í´ë¼ì´ì–¸íŠ¸ì™€ í†µì‹ í•˜ê¸° ìœ„í•œ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
- í”„ë¡œí† ì½œ, í˜¸ìŠ¤íŠ¸ ì´ë¦„, í¬íŠ¸ë¥¼ ì •ì˜
- [`listener.security.protocol.map`](http://listener.security.protocol.map) ìœ¼ë¡œ ë¦¬ìŠ¤ë„ˆì™€ í”„ë¡œí† ì½œ ë§¤í•‘ í•„ìš”
- í˜•ì‹ : `listeners={í”„ë¡œí† ì½œ}://{í˜¸ìŠ¤íŠ¸ëª…}:{í¬íŠ¸}`

```bash
# ë‹¨ì¼ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
listeners=PLAINTEXT://localhost:9092
listener.security.protocol.map=PLAINTEXT:PLAINTEXT

# ë‹¤ì¤‘ ë¦¬ìŠ¤ë„ˆ ì„¤ì • (ì‰¼í‘œë¡œ êµ¬ë¶„)
listeners=PLAINTEXT://localhost:9092,SSL://localhost:9093
listener.security.protocol.map=PLAINTEXT:PLAINTEXT,SSL:SSL

# ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì—°ê²° í—ˆìš©
listeners=PLAINTEXT://0.0.0.0:9092
listener.security.protocol.map=PLAINTEXT:PLAINTEXT
```

### ğŸŒ¿ zookeeper.connect

- ë¸Œë¡œì»¤ì˜ ë©”íƒ€ë°ì´í„°ê°€ ì €ì¥ë˜ëŠ” zookeeperì˜ ìœ„ì¹˜ë¥¼ ì •ì˜
- í˜•ì‹: `zookeeper.connect={í˜¸ìŠ¤íŠ¸}:{í¬íŠ¸}`

```bash
# localhostì˜ 2181ë²ˆ í¬íŠ¸ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì£¼í‚¤í¼ ì‚¬ìš©
zookeeper.connect=localhost:2181

# ì›ê²© ì£¼í‚¤í¼ ì„œë²„ ì§€ì •
zookeeper.connect=remote-zookeeper-host:2181

# ë‹¤ì¤‘ ì£¼í‚¤í¼ í™˜ê²½ì—ì„œ ì‰¼í‘œë¡œ ì—¬ëŸ¬ ì„œë²„ ì§€ì •
zookeeper.connect=zk1:2181,zk2:2181,zk3:2181
```

### ğŸŒ¿ log.dirs

- ë¡œê·¸ë¥¼ ì €ì¥í•  ë””ë ‰í† ë¦¬ ê²½ë¡œë¥¼ ì„¤ì •

```bash
# ë‹¨ì¼ ë””ë ‰í† ë¦¬ ì„¤ì •
log.dirs=/var/lib/kafka-logs

# ë‹¤ì¤‘ ë””ë ‰í† ë¦¬ ì„¤ì • (ì‰¼í‘œë¡œ êµ¬ë¶„)
log.dirs=/var/lib/kafka-logs1,/var/lib/kafka-logs2
```

### ğŸŒ¿ **num.recovery.threads.per.data.dir**

- ë¡œê·¸ë¥¼ ê´€ë¦¬í•˜ëŠ” ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì„¤ì •
- ì„¤ì •ëœ ê°’ì€ ë””ë ‰í† ë¦¬ë‹¹ ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì˜ë¯¸

```bash
# ë””ë ‰í† ë¦¬ë‹¹ 4ê°œì˜ ìŠ¤ë ˆë“œ ì‚¬ìš©
num.recovery.threads.per.data.dir=4

# Tip : ë””ë ‰í† ë¦¬ê°€ 3ê°œë¼ë©´ ì´ ìŠ¤ë ˆë“œ ìˆ˜ëŠ” 4 x 3 = 12
```

### ğŸŒ¿ auto.create.topics.enable

- ë¸Œë¡œì»¤ëŠ” ë‹¤ìŒ ìƒí™©ì—ì„œ í† í”½ì„ ìë™ ìƒì„± (default `true` )
    - í”„ë¡œë“€ì„œê°€ í† í”½ì— ë©”ì‹œì§€ë¥¼ ì“°ê¸° ì‹œì‘í•  ë•Œ
    - ì»¨ìŠˆë¨¸ê°€ í† í”½ìœ¼ë¡œë¶€í„° ë©”ì‹œì§€ë¥¼ ì½ê¸° ì‹œì‘í•  ë•Œ
    - í´ë¼ì´ì–¸íŠ¸ê°€ í† í”½ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ìš”ì²­í•  ë•Œ
- ëª…ì‹œì ìœ¼ë¡œ í† í”½ì„ ê´€ë¦¬í•˜ë ¤ë©´ `false` ë¡œ ì„¤ì •

```bash
# í† í”½ ìë™ ìƒì„± í™œì„±í™” (ê¸°ë³¸ê°’)
auto.create.topics.enable=true

# í† í”½ ìë™ ìƒì„± ë¹„í™œì„±í™”
auto.create.topics.enable=false
```

### ğŸŒ¿ delete.topic.enable

- í† í”½ ì‚­ì œ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ì„¤ì •
- ì‚­ì œ ìš”ì²­ ì‹œ ë°ì´í„°ì™€ ë©”íƒ€ë°ì´í„°ê°€ ëª¨ë‘ ì œê±°ë¨

```bash
# í† í”½ ì‚­ì œ í—ˆìš©
delete.topic.enable=true

# í† í”½ ì‚­ì œ ê¸ˆì§€
delete.topic.enable=false
```

## ğŸŒ³ Topic ê¸°ë³¸ ì„¤ì •(default)

### ğŸŒ¿ **num.partitions**

- ìƒˆë¡œìš´ í† í”½ ìƒì„± ì‹œÂ **íŒŒí‹°ì…˜ ìˆ˜**ë¥¼ ê²°ì •
- **ê¸°ë³¸ê°’:**Â `1`

```
# íŒŒí‹°ì…˜ ìˆ˜ ê¸°ë³¸ê°’ ì„¤ì •
num.partitions=1

# íŒŒí‹°ì…˜ ìˆ˜ë¥¼ 10ìœ¼ë¡œ ì„¤ì •
num.partitions=10

```

- 10ê°œì˜ íŒŒí‹°ì…˜ì´ 10ê°œì˜ ë¸Œë¡œì»¤ì— ë¶„ì‚°ë˜ë©´ ê° ë¸Œë¡œì»¤ì— í•˜ë‚˜ì˜ íŒŒí‹°ì…˜ ë¦¬ë” ë°°ì¹˜
- ë³‘ë ¬ ì²˜ë¦¬ ì„±ëŠ¥ì´ ìµœì í™”ë˜ê³  ì²˜ë¦¬ëŸ‰ ì¦ê°€

### ğŸŒ¿ **default.replication.factor**

- ìë™ ìƒì„±ëœ í† í”½ì˜ ë³µì œ íŒ©í„°(ë ˆí”Œë¦¬ì¹´ ìˆ˜)ë¥¼ ê²°ì •
- **ë³µì œ íŒ©í„°:**Â í† í”½ ë°ì´í„°ê°€ ë³µì œë˜ëŠ” ë¸Œë¡œì»¤ì˜ ê°œìˆ˜

```
# ë³µì œ íŒ©í„° ê¸°ë³¸ê°’ ì„¤ì •
default.replication.factor=3

```

- ë³µì œ íŒ©í„°ëŠ” í´ëŸ¬ìŠ¤í„°ì˜ ë¸Œë¡œì»¤ ìˆ˜ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì•„ì•¼ í•¨
- **`min.insync.replicas`**Â ì„¤ì •ê°’ë³´ë‹¤Â **ìµœì†Œ 1 ì´ìƒ**Â í¬ê²Œ ì„¤ì •í•˜ëŠ” ê²ƒì„ ê¶Œì¥

### ğŸŒ¿  **log.retention.ms**

- ë©”ì‹œì§€ì˜Â **ë³´ì¡´ ê¸°ê°„**ì„ ì„¤ì •
- ê¸°ë³¸ê°’:Â `7ì¼(604,800,000ms)`

```
# ë©”ì‹œì§€ ë³´ì¡´ ê¸°ê°„ì„ 7ì¼ë¡œ ì„¤ì • (ê¸°ë³¸ê°’)
log.retention.ms=604800000

# ë©”ì‹œì§€ ë³´ì¡´ ê¸°ê°„ì„ 3ì¼ë¡œ ì„¤ì •
log.retention.ms=259200000

```

### ğŸŒ¿ **log.retention.bytes**

- ë©”ì‹œì§€ ë³´ì¡´ ê¸°ì¤€ì„ ë©”ì‹œì§€ í¬ê¸°(ë°”ì´íŠ¸)ë¡œ ì„¤ì •
- ì„¤ì •ëœ ìš©ëŸ‰ì„ ì´ˆê³¼í•˜ë©´ ê°€ì¥ ì˜¤ë˜ëœ ë©”ì‹œì§€ë¶€í„° ì‚­ì œ

```
# ë©”ì‹œì§€ ë³´ì¡´ í¬ê¸°ë¥¼ 1GBë¡œ ì„¤ì •
log.retention.bytes=1073741824

# ë©”ì‹œì§€ ë³´ì¡´ í¬ê¸°ë¥¼ 500MBë¡œ ì„¤ì •
log.retention.bytes=524288000

```

### ğŸŒ¿ **log.segment.bytes**

- **ë¡œê·¸ ì„¸ê·¸ë¨¼íŠ¸ í¬ê¸°**ë¥¼ ì„¤ì •
- ì„¤ì •ëœ í¬ê¸°ì— ë„ë‹¬í•˜ë©´ ê¸°ì¡´ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë‹«ê³ , ìƒˆë¡œìš´ ì„¸ê·¸ë¨¼íŠ¸ íŒŒì¼ì„ ìƒì„±

```
# ì„¸ê·¸ë¨¼íŠ¸ í¬ê¸°ë¥¼ 1GBë¡œ ì„¤ì •
log.segment.bytes=1073741824

```

### ğŸŒ¿ **log.roll.ms**

- **ë¡œê·¸ ì„¸ê·¸ë¨¼íŠ¸ íŒŒì¼ì´ ë‹«íˆëŠ” ì‹œê°„ ê¸°ì¤€**ì„ ì„¤ì •

```
# ë¡œê·¸ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ 1ì‹œê°„(3600000ms)ë§ˆë‹¤ ë‹«ìŒ
log.roll.ms=3600000
```

### ğŸŒ¿ **min.insync.replicas**

- ìµœì†Œ ë™ê¸°í™” ë ˆí”Œë¦¬ì¹´ ìˆ˜ ì„¤ì •
- ì„¤ì •ëœ ê°’ë§Œí¼ì˜ ë ˆí”Œë¦¬ì¹´ê°€ ìµœì‹  ìƒíƒœì—¬ì•¼ ì“°ê¸° ì‘ì—… ì„±ê³µ

### ğŸŒ¿ **message.max.bytes**

- **ë©”ì‹œì§€ í¬ê¸° ìƒí•œ**ì„ ì„¤ì •í•˜ì—¬ ë¸Œë¡œì»¤ê°€ í—ˆìš©í•˜ëŠ” ìµœëŒ€ ë©”ì‹œì§€ í¬ê¸°ë¥¼ ì •ì˜
- **ê¸°ë³¸ê°’:**Â `1MB`
- ë©”ì‹œì§€ í¬ê¸°ë¥¼ ì´ˆê³¼í•˜ë©´ ë¸Œë¡œì»¤ëŠ” ë©”ì‹œì§€ë¥¼ ê±°ë¶€í•˜ê³  ì˜¤ë¥˜ë¥¼ ë°˜í™˜
- í”„ë¡œë“€ì„œ(`max.request.size`)ì™€ ì»¨ìŠˆë¨¸(`fetch.message.max.bytes`) ì„¤ì • ê°’ê³¼ ì¼ì¹˜í•´ì•¼ í•¨

## ğŸŒ³ í•˜ë“œì›¨ì–´ ì„ íƒí•˜ê¸°

### ğŸŒ¿ ë””ìŠ¤í¬ ì²˜ë¦¬ëŸ‰

- ë©”ì‹œì§€ë¥¼ ë””ìŠ¤í¬ì— ê¸°ë¡í•  ë•Œ ë””ìŠ¤í¬ ì²˜ë¦¬ëŸ‰ì´ ì“°ê¸° ì§€ì—°ì— ì˜í–¥ì„ ë¯¸ì¹¨
- ê³ ì† ë””ìŠ¤í¬ ì‚¬ìš© ê¶Œì¥

### ğŸŒ¿ ë””ìŠ¤í¬ ìš©ëŸ‰

- ë©”ì‹œì§€ ë³´ì¡´ ê¸°ê°„ ë˜ëŠ” ë³´ì¡´ ìš©ëŸ‰ì— ë”°ë¼ ë””ìŠ¤í¬ í¬ê¸°ë¥¼ ì„¤ì •í•´ì•¼ í•¨
- ex) í•˜ë£¨ 1TB íŠ¸ë˜í”½, ì¼ì£¼ì¼ ë³´ì¡´ â†’ 7TB + 10% ì—¬ìœ  ê³µê°„

### ğŸŒ¿ ë©”ëª¨ë¦¬

- í˜ì´ì§€ ìºì‹œ í™œìš© : ë” ë§ì€ ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ê°€ ìˆìœ¼ë©´ í˜ì´ì§€ ìºì‹œë¥¼ ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ ìˆì–´, consumer í´ë¼ì´ì–¸íŠ¸ì˜ ì„±ëŠ¥ì´ í–¥ìƒë¨
    
    > í˜ì´ì§€ ìºì‹œë€, ìš´ì˜ì²´ì œê°€ ë””ìŠ¤í¬ I/O ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ìœ¼ë¡œ, ìì£¼ ì ‘ê·¼í•˜ëŠ” ë””ìŠ¤í¬ ë°ì´í„°ë¥¼ RAMì— ìºì‹±í•œë‹¤.
    > 
- kafkaì™€ ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ **ê°™ì€ ì‹œìŠ¤í…œì—ì„œ ìš´ì˜í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ê¶Œì¥**
    
    > KafkaëŠ” ì„±ëŠ¥ì„ ìœ„í•´ ê°€ëŠ¥í•œ ë§ì€ ë©”ëª¨ë¦¬ë¥¼ í˜ì´ì§€ ìºì‹œë¡œ í™œìš©í•˜ë ¤ê³  í•œë‹¤. ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê°™ì€ ì‹œìŠ¤í…œì—ì„œ ì‹¤í–‰ë˜ë©´ í˜ì´ì§€ ìºì‹œë¥¼ ë‘ê³  ê²½ìŸí•˜ê²Œ ë˜ê³ , ì´ë¡œ ì¸í•´ Kafkaì˜ í˜ì´ì§€ ìºì‹œ íˆíŠ¸ìœ¨ì´ ë‚®ì•„ì§€ê³  ë””ìŠ¤í¬ I/Oê°€ ì¦ê°€í•˜ì—¬ ì„±ëŠ¥ì´ ì €í•˜ëœë‹¤.
    > 

### ğŸŒ¿ ë„¤íŠ¸ì›Œí¬

- ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ì´ ì¹´í”„ì¹´ ì²˜ë¦¬ëŸ‰ ìƒí•œì„ ì„ ê²°ì •í•¨
- ë„¤íŠ¸ì›Œí¬ê°€ í¬í™” ìƒíƒœê°€ ë˜ë©´, í´ëŸ¬ìŠ¤í„° ë³µì œ ì‘ì—…ì— ì§€ì—°ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ
- ì˜ˆìƒ íŠ¸ë˜í”½ê³¼ ë³µì œ ì‘ì—…ì„ ê°ì•ˆí•´ ì¶©ë¶„í•œ ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ í™•ë³´ í•„ìš”

### ğŸŒ¿ CPU

- KafkaëŠ” ë©”ì‹œì§€ ì••ì¶•, ì²´í¬ì„¬ í™•ì¸, ì˜¤í”„ì…‹ ë¶€ì—¬ ë“±ì— CPUë¥¼ ì‚¬ìš©
- ë””ìŠ¤í¬ë‚˜ ë©”ëª¨ë¦¬ë§Œí¼ ì¤‘ìš”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì ì • ìˆ˜ì¤€ì˜ í• ë‹¹ ê¶Œì¥

## ğŸŒ³ Kafka Cluster êµ¬ì„±

ë‹¨ì¼ ì¹´í”„ì¹´ ë¸Œë¡œì»¤ëŠ” ë¡œì»¬ ê°œë°œ ì‘ì—…ì´ë‚˜ ê°œë… ìê²© ì¦ëª… ì‹œìŠ¤í…œì— ì í•©í•˜ì§€ë§Œ, í´ëŸ¬ìŠ¤í„°ë¡œ êµ¬ì„±ëœ ì—¬ëŸ¬ ë¸Œë¡œì»¤ê°€ ìˆìœ¼ë©´ ìƒë‹¹í•œ ì´ì ì´ ìˆë‹¤. ê°€ì¥ í° ì´ì ì€ ì—¬ëŸ¬ ì„œë²„ì— ë¶€í•˜ë¥¼ ë¶„ì‚°ì‹œí‚¬ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ë˜í•œ ë³µì œë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¨ì¼ ì‹œìŠ¤í…œ ì¥ì• ë¡œ ì¸í•œ ë°ì´í„° ì†ì‹¤ì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.

### ğŸŒ¿ ë¸Œë¡œì»¤ ìˆ˜

- í´ëŸ¬ìŠ¤í„° í¬ê¸° ê²°ì • ìš”ì†Œ
    - ë””ìŠ¤í¬ ìš©ëŸ‰
    - ë¸Œë¡œì»¤ë‹¹ ë ˆí”„ë¦¬ì¹´ ìš©ëŸ‰
    - CPU ìš©ëŸ‰
    - ë„¤íŠ¸ì›Œí¬ ëŒ€ì—¬ê³¡
- ë¸Œë¡œì»¤ ìˆ˜ ì„¤ì • ì˜ˆì‹œ
    - 10 TB ë°ì´í„°ë¥¼ ì €ì¥í•˜ë ¤ë©´ (ë¸Œë¡œì»¤ë‹¹ ì €ì¥ ìš©ëŸ‰ì´ 2TBì¼ ê²½ìš°) â†’ ìµœì†Œ 5ê°œì˜ ë¸Œë¡œì»¤ í•„ìš”
    - replication-factorë¥¼ 2ë¡œ ì„¤ì •í•˜ë ¤ë©´ ë°ì´í„°ê°€ ê° ë¸Œë¡œì»¤ì— ë³µì œë˜ì–´ 10ê°œì˜ ë¸Œë¡œì»¤ í•„ìš”

### ğŸŒ¿ ìš´ì˜ì²´ì œ íŠœë‹í•˜ê¸°

- ê°€ìƒ ë©”ëª¨ë¦¬
    - í˜ì´ì§€ ìºì‹œ í™œìš© : ë””ìŠ¤í¬ I/O ì„±ëŠ¥ì„ ìœ„í•´ ë”í‹° í˜ì´ì§€ ê´€ë¦¬ í•„ìš”
    - ìŠ¤ì™‘ ë©”ëª¨ë¦¬ ìµœì†Œí™” : ìŠ¤ì™‘ ê³µê°„ ëŒ€ì‹  í˜ì´ì§€ ìºì‹œì— ë©”ëª¨ë¦¬ë¥¼ ìš°ì„  í• ë‹¹
- ë””ìŠ¤í¬
    - íŒŒì¼ ì‹œìŠ¤í…œ ì¶”ì²œ
        - Ext4 ë˜ëŠ” XFS ì‚¬ìš©
        - XFSëŠ” ì¶”ê°€ íŠœë‹ ì—†ì´ë„ ì¹´í”„ì¹´ ì›Œí¬ë¡œë“œì— ì í•©
- ë„¤íŠ¸ì›Œí‚¹
    - ì†¡ì‹  ë° ìˆ˜ì‹  ë²„í¼ í¬ê¸° ì„¤ì •
    - ë¸Œë¡œì»¤ ë™ì‹œ í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ìˆ˜ ì„¤ì •

## ğŸŒ³ í”„ë¡œë•ì…˜ í™˜ê²½ ê³ ë ¤ì‚¬í•­

### ğŸŒ¿ GC ì˜µì…˜

- kafkaëŠ” G1GC(Garbage-First garbage collector)ë¥¼ ê¸°ë³¸ GCë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥
- G1GCëŠ” ë‹¤ì–‘í•œ ì‘ì—… ë¶€í•˜ë¥¼ ì¡°ì ˆí•˜ê³  ì¼ì •í•œ GC ì •ì§€ ì‹œê°„ì„ ìœ ì§€
- **ì£¼ìš” ì˜µì…˜**
    - **`MaxGCPauseMillis`**
        - GCì˜ ìµœëŒ€ ì •ì§€ ì‹œê°„ ì„¤ì •
        - ì§§ê²Œ ì„¤ì •í•˜ë©´ ì‘ë‹µì„±ì´ í–¥ìƒë˜ì§€ë§Œ ì²˜ë¦¬ëŸ‰ì´ ì¤„ì–´ë“¤ ìˆ˜ ìˆìŒ
    - **`InitiatingHeapOccupancyPercent`**
        - GCê°€ ì‹œì‘ë˜ëŠ” í™ ë©”ëª¨ë¦¬ ì‚¬ìš© ë¹„ìœ¨ ì„¤ì •
        - ex.Â `45`ë¡œ ì„¤ì • ì‹œ í™ì˜ 45%ë¥¼ ì‚¬ìš©í•˜ë©´ GC ì‹œì‘
- **ê¶Œì¥ ì‚¬í•­**
    - ì¹´í”„ì¹´ëŠ” í™ ë©”ëª¨ë¦¬ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•˜ë©° GC ëŒ€ìƒ ê°ì²´ë¥¼ ì ê²Œ ìƒì„±
    - ìœ„ ì„¤ì •ê°’ì„ ë‚®ê²Œ ì¡ì•„ë„ ì„±ëŠ¥ì— í° ì˜í–¥ ì—†ìŒ

### ğŸŒ¿ **ë°ì´í„°ì„¼í„° ë ˆì´ì•„ì›ƒ**

- ë¸Œë¡œì»¤ ê°„Â **ë™(Rack) ìœ„ì¹˜**ë¥¼ ê³ ë ¤í•˜ì—¬ ì¥ì•  ë°œìƒ ì‹œ ë°ì´í„° ê°€ìš©ì„±ì„ ë³´ì¥
    
    > ë™(Rack)ì€ ë°ì´í„° ì„¼í„°ì—ì„œ ì„œë²„ì™€ ë„¤íŠ¸ì›Œí¬ ì¥ë¹„ë¥¼ ë¬¼ë¦¬ì ìœ¼ë¡œ ë³´ê´€í•˜ëŠ” ìºë¹„ë‹› ë˜ëŠ” í”„ë ˆì„ì„ ë§í•œë‹¤. í˜„ëŒ€ DCì—ì„œëŠ” ì—¬ëŸ¬ ì„œë²„ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ê³µê°„ì„ ì ˆì•½í•˜ê¸° ìœ„í•´ í‘œì¤€í™”ëœ ë™ì„ ì‚¬ìš©í•œë‹¤.
    > 
- ë™ì¼ ë™ì— ë ˆí”Œë¦¬ì¹´ê°€ ë°°ì¹˜ë˜ì§€ ì•Šë„ë¡ êµ¬ì„±(ì¥ì•  ë„ë©”ì¸ ë¶„ë¦¬)
- **ì„¤ê³„ ê°€ì´ë“œ**
    - ê° ë¸Œë¡œì»¤ë¥¼ ì„œë¡œ ë‹¤ë¥¸ ë™ ë˜ëŠ” ë°ì´í„°ì„¼í„°ì— ë°°ì¹˜
    - ë‹¨ì¼ ì¥ì• ì (ì „ì›, ë„¤íŠ¸ì›Œí¬ ë“±)ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ êµ¬ì„±

### ğŸŒ¿ **ì£¼í‚¤í¼ ê³µìœ í•˜ê¸°**

- ì¹´í”„ì¹´ëŠ”Â **ZooKeeper**ë¥¼ ì‚¬ìš©í•´ ë¸Œë¡œì»¤, í† í”½, íŒŒí‹°ì…˜ ë©”íƒ€ë°ì´í„° ê´€ë¦¬
- **ì£¼í‚¤í¼ ì‘ë™ ë°©ì‹**
    - ì»¨ìŠˆë¨¸ ê·¸ë£¹ ë˜ëŠ” í´ëŸ¬ìŠ¤í„° êµ¬ì„± ë³€ê²½ ì‹œì—ë§Œ ì“°ê¸° ì‘ì—… ë°œìƒ
    - ì´ëŸ¬í•œ ì‘ì—…ì€ ë¹ˆë²ˆí•˜ê²Œ ë°œìƒí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì£¼í‚¤í¼ì— ë°œìƒí•˜ëŠ” ë¶€í•˜ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì ë‹¤.
    - í•˜ë‚˜ì˜ ì¹´í”„ì¹´ í´ëŸ¬ìŠ¤í„°ë§Œì„ ìœ„í•´ ì£¼í‚¤í¼ ì•™ìƒë¸”(ì—¬ëŸ¬ ì£¼í‚¤í¼ ì„œë²„ë¡œ êµ¬ì„±ëœ ê·¸ë£¹)ì„ ë”°ë¡œ êµ¬ì¶•í•˜ëŠ” ê²ƒì€ ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ì¼ ìˆ˜ ìˆë‹¤ â†’ í•˜ë‚˜ì˜ ì£¼í‚¤í¼ ì•™ìƒë¸”ì„ ì—¬ëŸ¬ ì¹´í”„ì¹´ í´ëŸ¬ìŠ¤í„°ê°€ ê³µìœ í•˜ëŠ” ê²ƒì´ ë” íš¨ìœ¨ì ì´ë‹¤.

# Ch3. Kafka Producer **: ì¹´í”„ì¹´ì— ë©”ì‹œì§€ ì“°ê¸°**

## ğŸŒ³ í”„ë¡œë“€ì„œ ê°œìš”

- **í”„ë¡œë“€ì„œì˜ ì—­í• **: ë°ì´í„°ë¥¼ ì¹´í”„ì¹´ ë¸Œë¡œì»¤ì— ì „ì†¡
- **ì£¼ìš” ê°œë…**
    - **`ProducerRecord`**: ì¹´í”„ì¹´ì— ë©”ì‹œì§€ë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•œ ê°ì²´
    - **`KafkaProducer`**: í”„ë¡œë“€ì„œë¥¼ êµ¬ì„±í•˜ê³  ë¸Œë¡œì»¤ì™€ í†µì‹ ì„ ë‹´ë‹¹
    - **íŒŒí‹°ì…˜**: ë©”ì‹œì§€ê°€ ì €ì¥ë˜ëŠ” ë¸Œë¡œì»¤ì˜ ë…¼ë¦¬ì  ë‹¨ìœ„
- **ì‚¬ìš© ì˜ˆì‹œ**
    - ì‹ ìš©ì¹´ë“œ íŠ¸ëœì­ì…˜ ì²˜ë¦¬
    - ì›¹ì‚¬ì´íŠ¸ ì¡°íšŒ ë¡œê·¸ ì „ì†¡ ë“±

## ğŸŒ³ **í”„ë¡œë“€ì„œ ê¸°ë³¸ êµ¬ì¡°**

- **`ProducerRecord`**Â ê°ì²´ë¥¼ ìƒì„±í•˜ë©° ì‹œì‘
    - **í† í”½**ê³¼Â **ë°¸ë¥˜**ëŠ” í•„ìˆ˜, í‚¤ì™€ íŒŒí‹°ì…˜ì€ ì„ íƒì ìœ¼ë¡œ ì§€ì •
- ë©”ì‹œì§€ ì „ì†¡ ê³¼ì •
    1. **ì§ë ¬í™”**: í‚¤ì™€ ê°’ì„ ë°”ì´íŠ¸ ë°°ì—´ë¡œ ë³€í™˜
    2. **íŒŒí‹°ì…”ë‹**: í‚¤ê°€ ìˆìœ¼ë©´ í•´ì‹±, ì—†ìœ¼ë©´ Round Robin ë°©ì‹ìœ¼ë¡œ íŒŒí‹°ì…˜ ê²°ì •
    3. **ë°°ì¹˜ ì¶”ê°€**: ì§ë ¬í™”ëœ ë©”ì‹œì§€ë¥¼ ë ˆì½”ë“œ ë°°ì¹˜ì— ì¶”ê°€
    4. **ì „ì†¡**: ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œê°€ ë ˆì½”ë“œ ë°°ì¹˜ë¥¼ ë¸Œë¡œì»¤ë¡œ ì „ì†¡

## ğŸŒ³ **í•„ìˆ˜ ì„¤ì •**

- **`bootstrap.servers`**
    - Kafka í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ì´ˆê¸° ì—°ê²°ì„ ì„¤ì •í•˜ê¸° ìœ„í•´, producerê°€ ì‚¬ìš©í•  ë¸Œë¡œì»¤ì˜Â `host:port`Â ëª©ë¡ì„ ì§€ì •
    - ìµœì†Œ 2ê°œ ì´ìƒì˜ ë¸Œë¡œì»¤ë¥¼ ì„¤ì •í•˜ì—¬ ì—°ê²° ì•ˆì •ì„±ì„ ë†’ì„
- **`key.serializer`,Â `value.serializer`**
    - ë©”ì‹œì§€ í‚¤ì™€ ê°’ì„ ì§ë ¬í™”í•˜ê¸° ìœ„í•œ ì„¤ì •
    - Producerê°€ key-valueë¥¼ ì§ë ¬í™”í•˜ëŠ”ë° ì‚¬ìš©í•  í´ë˜ìŠ¤ì˜ ì´ë¦„
    - ì¼ë°˜ì ìœ¼ë¡œÂ `StringSerializer`Â ë˜ëŠ”Â `ByteArraySerializer`ë¥¼ ì‚¬ìš©í•¨

## ğŸŒ³ **ë©”ì‹œì§€ ì „ì†¡ ë°©ì‹**

- **íŒŒì´ì–´ ì•¤ í¬ê²Ÿ**
    - ë©”ì‹œì§€ë¥¼ ì „ì†¡í•œ ë’¤ ì„±ê³µ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì§€ ì•ŠìŒ
    - ì²˜ë¦¬ ì†ë„ê°€ ë¹ ë¥´ì§€ë§Œ ë©”ì‹œì§€ ì†ì‹¤ ê°€ëŠ¥ì„±ì´ ìˆìŒ
- **ë™ê¸° ì „ì†¡**
    - `send()`Â í˜¸ì¶œ í›„Â `get()`ìœ¼ë¡œ ê²°ê³¼ë¥¼ ë°˜í™˜ë°›ìŒ
    - ì „ì†¡ ê²°ê³¼ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ ìŠ¤ë ˆë“œê°€ ë¸”ë¡ë¨
    - `Future`Â ê°ì²´ë¥¼ í™œìš©í•˜ì—¬ ë¹„ë™ê¸° ê²°ê³¼ë¥¼ ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬
- **ë¹„ë™ê¸° ì „ì†¡**
    - ì½œë°± í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ë¥¼ ì²˜ë¦¬
    - ì „ì†¡ ê²°ê³¼ì— ë”°ë¼ ìë™ìœ¼ë¡œ ì½œë°±ì´ í˜¸ì¶œë¨
    - ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì„ ìµœì†Œí™”í•˜ë©° íš¨ìœ¨ì ì¸ ë°©ì‹ì„

## ğŸŒ³ **ì£¼ìš” í”„ë¡œë“€ì„œ ì„¤ì •**

- **`acks`Â (Acknowledgment Level)**
    - ë©”ì‹œì§€ ì „ì†¡ ì‹ ë¢°ì„±ì„ ì„¤ì •(producerê°€ ì“°ê¸° ì„±ê³µìœ¼ë¡œ ê°„ì£¼í•˜ê¸° ì „ì— ëª‡ ê°œì˜ ë³µì œë³¸ì´ ë ˆì½”ë“œë¥¼ ë°›ì•„ì•¼ í•˜ëŠ”ì§€ ì œì–´
        - `acks=0`: ìµœì†Œ ì „ì†¡ ë³´ì¥ At Most Once â†’ ë©”ì‹œì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆë‹¤ê³  ê°€ì •í•˜ê¸° ì „ì— ë¸Œë¡œì»¤ë¡œë¶€í„° ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ì§€ ì•ŠìŒ
            - ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ë¸Œë¡œì»¤ê°€ ë©”ì‹œì§€ë¥¼ ë°›ì§€ ëª»í•œ ê²½ìš° producerëŠ” ì•Œì§€ ëª»í•˜ê³  ë©”ì‹œì§€ê°€ ì†ì‹¤ë¨
        - `acks=1`: ì¤‘ë³µ ê°€ëŠ¥ì„±ì„ í—ˆìš©í•˜ëŠ” At Least Once â†’ ë¦¬ë” ë³µì œë³¸ì´ ë©”ì‹œì§€ë¥¼ ë°›ëŠ” ìˆœê°„ ë¸Œë¡œì»¤ë¡œë¶€í„° ì„±ê³µ ì‘ë‹µì„ ë°›ëŠ”ë‹¤.
            - ë¦¬ë”ê°€ ì¶©ëŒí•˜ê³  ìµœì‹  ë©”ì‹œì§€ê°€ ì•„ì§ ìƒˆ ë¦¬ë”ì— ë³µì œë˜ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” ë©”ì‹œì§€ê°€ ì—¬ì „íˆ ì†ì‹¤ë  ìˆ˜ ìˆë‹¤.
        - `acks=all`: ëª¨ë“  ë ˆí”Œë¦¬ì¹´ì˜ í™•ì¸ì„ ìš”êµ¬í•˜ëŠ” Exactly Once â†’ ëª¨ë“  ë™ê¸°í™” ë³µì œë³¸ì´ ë©”ì‹œì§€ë¥¼ ë°›ìœ¼ë©´ ë¸Œë¡œì»¤ë¡œë¶€í„° ì„±ê³µ ì‘ë‹µì„ ë°›ëŠ”ë‹¤.
- **`linger.ms`**
    - ë°°ì¹˜ ì „ì†¡ ì „ ëŒ€ê¸° ì‹œê°„ì„ ì„¤ì •í•˜ì—¬ íš¨ìœ¨ì„±ì„ ë†’ì„
- **`buffer.memory`**
    - ì „ì†¡ ëŒ€ê¸° ì¤‘ì¸ ë©”ì‹œì§€ë¥¼ ì €ì¥í•  ë²„í¼ í¬ê¸°
- **`compression.type`**
    - ë©”ì‹œì§€ ì••ì¶• ë°©ì‹ ì„¤ì • (`gzip`,Â `snappy`,Â `lz4`)
- **`enable.idempotence`**
    - ë©”ì‹œì§€ë¥¼ ì •í™•íˆ í•œ ë²ˆë§Œ ì „ì†¡í•˜ë„ë¡ ë³´ì¥
    - ë©”ì‹œì§€ ìˆœì„œì™€ ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•œ í•„ìˆ˜ ì„¤ì •

## ğŸŒ³ **ì‹œë¦¬ì–¼ë¼ì´ì €ì™€ ìŠ¤í‚¤ë§ˆ**

- **ê¸°ë³¸ ì‹œë¦¬ì–¼ë¼ì´ì €**
    - `StringSerializer`,Â `ByteArraySerializer`Â ë“± ì œê³µ
- **ë²”ìš© ì§ë ¬í™” ë¼ì´ë¸ŒëŸ¬ë¦¬**
    - Apache Avroì™€ ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê¶Œì¥
    - ë°ì´í„° íƒ€ì…ê³¼ ìŠ¤í‚¤ë§ˆë¥¼ ìœ ì§€í•˜ë©´ì„œ íš¨ìœ¨ì ì¸ ì§ë ¬í™” ì§€ì›
    - ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‹œ ê¸°ì¡´ ì»¨ìŠˆë¨¸ì™€ì˜ í˜¸í™˜ì„± ìœ ì§€ ê°€ëŠ¥

## ğŸŒ³ **íŒŒí‹°ì…˜ê³¼ ì ‘ì°©ì„± ì²˜ë¦¬**

- **íŒŒí‹°ì…˜ í• ë‹¹ ë°©ì‹**
    - í‚¤ ê°’ì´ ì¡´ì¬í•˜ë©´ í•´ì‹±í•˜ì—¬ íŒŒí‹°ì…˜ ê²°ì •
    - ~~í‚¤ ê°’ì´ ì—†ìœ¼ë©´ Round Robin ë°©ì‹ìœ¼ë¡œ íŒŒí‹°ì…˜ í• ë‹¹~~
        - 2.4 ë²„ì „ë¶€í„° ê¸°ë³¸ì ìœ¼ë¡œ Sticky Partitioning ë°©ì‹ì„ ì‚¬ìš©í•¨
- **ì ‘ì°©ì„± ì²˜ë¦¬**
    - í‚¤ ê°’ì´ ì—†ëŠ” ë©”ì‹œì§€ë“¤ì„ ê°™ì€ ë°°ì¹˜ë¡œ ë¬¶ì–´ ì „ì†¡í•˜ì—¬ íš¨ìœ¨ì„±ì„ ë†’ì„

## ğŸŒ³ **ë ˆì½”ë“œ í—¤ë”**

- ë©”ì‹œì§€ì˜ í‚¤ì™€ ê°’ ì™¸ì— ì¶”ê°€ì ì¸ ë©”íƒ€ë°ì´í„°ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŒ
- ë©”ì‹œì§€ë¥¼ íŒŒì‹±í•˜ì§€ ì•Šê³ ë„ í—¤ë” ì •ë³´ë¥¼ í™œìš©í•´ ë©”ì‹œì§€ë¥¼ í•´ì„ ê°€ëŠ¥

## ğŸŒ³ **ì¸í„°ì…‰í„°**

- **`onSend`**
    - ë©”ì‹œì§€ê°€ ë¸Œë¡œì»¤ë¡œ ì „ì†¡ë˜ê¸° ì „ì— í˜¸ì¶œë˜ë©°, ë©”ì‹œì§€ ë‚´ìš©ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŒ
- **`onAcknowledgement`**
    - ë¸Œë¡œì»¤ ì‘ë‹µì„ ìˆ˜ì‹ í•œ í›„ í˜¸ì¶œë˜ë©°, ë©”ì‹œì§€ë¥¼ ì½ê¸° ì „ìš©ìœ¼ë¡œ ì²˜ë¦¬

## ğŸŒ³ **ì¿¼í„° ë° ì“°ë¡œí‹€ë§**

- **ë¸Œë¡œì»¤ ì²˜ë¦¬ëŸ‰ ì´ˆê³¼ ì‹œ ë°œìƒí•˜ëŠ” ë¬¸ì œ**
    - í´ë¼ì´ì–¸íŠ¸ ë²„í¼ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•˜ë©´Â `send()`Â í˜¸ì¶œì´ ë¸”ë¡ë¨
    - `delivery.timeout.ms`ë¥¼ ì´ˆê³¼í•˜ë©´ ë©”ì‹œì§€ê°€ ë¬´íš¨í™”ë¨
- **í•´ê²° ë°©ë²•**
    - ë¸Œë¡œì»¤ì™€ í”„ë¡œë“€ì„œ ê°„ ë³‘ëª©í˜„ìƒì„ ëª¨ë‹ˆí„°ë§í•˜ë©° ì„¤ì •ê°’ ì¡°ì • í•„ìš”

# ì¹´í”„ì¹´ ì™„ë²½ ê°€ì´ë“œ - ì½”ì–´í¸

> ğŸ”— [https://www.inflearn.com/course/ì¹´í”„ì¹´-ì™„ë²½ê°€ì´ë“œ-ì½”ì–´?srsltid=AfmBOoqevFk6v7QNyxpS8gOYwIryzN68uyOuMqNrVJtxpeK4JDdlmiIX](https://www.inflearn.com/course/%EC%B9%B4%ED%94%84%EC%B9%B4-%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C-%EC%BD%94%EC%96%B4?srsltid=AfmBOoqevFk6v7QNyxpS8gOYwIryzN68uyOuMqNrVJtxpeK4JDdlmiIX)
> 

## ğŸ… Kafka ì†Œê°œ, ê·¸ë¦¬ê³  ì™œ Kafkaë¥¼ ë°°ì›Œì•¼ í•˜ëŠ”ê°€?

- ë‹¤ì–‘í•œ ëŒ€ëŸ‰ ë°ì´í„°ì˜ ìˆ˜ì§‘/ê°€ê³µ/ì €ì¥ì„ ìœ„í•œ í•µì‹¬ ì†”ë£¨ì…˜
- ê¸°ì—… ë°ì´í„° ì €ì¥ì†Œì˜ í†µí•© êµ¬ì¶• ê¸°ë°˜ ì œê³µí•˜ë©°, ê³ ì„±ëŠ¥ ë°ì´í„° íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ì˜ í•µì‹¬ ì—­í• ì„ ìˆ˜í–‰
- ë¶„ì‚° ëŒ€ìš©ëŸ‰ ë©”ì‹œì§• ì‹œìŠ¤í…œì˜ ê°€ì¥ ëŒ€í‘œì ì¸ ì†”ë£¨ì…˜

### Kafkaì˜ ì£¼ìš” íŠ¹ì§•

- ë›°ì–´ë‚œ í•µì‹¬ ê¸°ëŠ¥
- ë‹¤ì–‘í•œ í™˜ê²½ ì§€ì›
- ì‹ ë¢°ì„±ê³¼ í¸ì˜ì„±

### ì™œ Kafkaë¥¼ ë°°ì›Œì•¼ í•˜ëŠ”ê°€

- ì¢‹ì€ ì†”ë£¨ì…˜ì´ê³  í˜„ì¬ë„ ë§ì´ ì‚¬ìš©ë˜ê³  ìˆìœ¼ë©°, ì•ìœ¼ë¡œë„ ë§ì´ ì‚¬ìš©ë  ê²ƒì´ë‹¤.
- ëì—†ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ì˜ ë³€í™”ì™€ ë°ì´í„° í™œìš© ìš•êµ¬, ìƒˆë¡œìš´ ê¸°ìˆ ì˜ ë“±ì¥, ëŠ˜ì–´ë§Œ ê°€ëŠ” ì„œë¸Œ ì‹œìŠ¤í…œë“¤ì€ ë³€í•¨ì—†ì´ ì§€ì†ë  ê²ƒì´ë‹¤.
- ë¶ˆê³¼ ëª‡ë…„ ì „ ìˆ˜ì¤€ì—ì„œëŠ” ìƒìƒí•  ìˆ˜ ì—†ì—‡ë˜ ë°ì´í„° ì²˜ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ê³¼ ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ì†”ë£¨ì…˜ë“¤ì´ ë“±ì¥í•˜ê³  ìˆë‹¤.
- KafkaëŠ” ê¸‰ë³€í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì„ ìˆ˜ìš©í•˜ëŠ” ê¸°ì—… ë°ì´í„° ì¸í”„ë¼ë“¤ì„ íš¨ìœ¨ì ìœ¼ë¡œ í†µí•©í•˜ê³  ìœ ì—°í•˜ê²Œ í™œìš©í•˜ëŠ”ë° ê¸°ì—¬í•˜ê¸°ì—, ê·¸ ì¤‘ìš”ë„ëŠ” ì•ìœ¼ë¡œ ë”ìš± ë†’ì•„ì§ˆ ê²ƒì´ë‹¤.

## ğŸ… Kafka ì‹¤ìŠµ í™˜ê²½ êµ¬ì¶•

### Kafka ì„œë²„ êµ¬ì¶•

- Oracle Virtualbox ë‹¤ìš´ë¡œë“œ
- Ubuntu 20 ì„¤ì¹˜ ë° í™˜ê²½ êµ¬ì„±
- JDK ë° Confluent Kafka ì„¤ì¹˜

### Kafka í´ë¼ì´ì–¸íŠ¸ êµ¬ì¶•

- JDK ì„¤ì¹˜
- IntelliJ ì„¤ì¹˜
- ê¸°íƒ€ íˆ´ ì„¤ì¹˜

![image](https://github.com/user-attachments/assets/a1e35431-05fe-4742-8395-4f75c3d7113c)


## ğŸ… Kafka ì„¤ì¹˜ Binary ê°œìš”

### Apache Kafka

> ë§í¬ë“œì¸ì—ì„œ ë‚´ë¶€ì ìœ¼ë¡œ ë©”ì‹œì§• ì‹œìŠ¤í…œ ì“°ë ¤ê³  ìê¸°ë“¤ì´ ë§Œë“  ê²ƒ
> 
- Apache KafkaëŠ” Open Source ê¸°ë°˜ìœ¼ë¡œ ë¹„ìš© Free
- ë§ì€ Community ì‚¬ìš©ì ì¸µì„ ê°€ì§€ê³  ìˆìŒ

### Confluent Kafka

> ì»¨í”Œë£¨ì–¸íŠ¸ í”Œë«í¼ì´ í¬í•¨ëœ ê°€ì¥ ì™„ì „í•œ ì¹´í”„ì¹´ì˜ ë°°í¬íŒ
> 
- Apache Kafkaë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ì§€ë§Œ, ì¶”ê°€ ê¸°ëŠ¥ì´ í¬í•¨ëœ ìƒìš© ë°°í¬íŒ
- Connector, Schema Registry ë“± Kafka ê¸°ë°˜ì˜ ë‹¤ë¥¸ ëª¨ë“ˆê³¼ ì¼ì²´í™”ëœ platform ì œê³µ
- Confluent Kafka Communtity ë²„ì „ì€ Open Source
ê¸°ë°˜ìœ¼ë¡œ ë¹„ìš© Free
- Confluent Kafka Local Platformì€ ê°œë°œìš©ë„ë¡œ ë‹¨ 1ê°œì˜ Brokerê¸°ë°˜ì—ì„œë§Œ ë™ì‘. ë¹„ìš© Freeì´ë©° Admin UIë¥¼ ì´ìš©í•˜ì—¬ Kafkaì˜ ë‹¤ì–‘í•œ Component ë“¤ì„ ê´€ë¦¬í•˜ê³  ëª¨ë‹ˆí„°ë§ ìˆ˜í–‰ ê°€ëŠ¥
    - Admin UI : ëª¨ë‹ˆí„°ë§ ìš©ì´, ì˜¤í”ˆì†ŒìŠ¤ UIë³´ë‹¤ ë” ì§ê´€ì 
- Confluent Kafka Distributed Platformì€ ìœ ë£Œ

### í™˜ê²½ ìŠ¤íƒ

- ì„œë²„ Kafka í™˜ê²½ì€ Confluent Kafka 7.1.x(Apacha Kafa 3.1.xì™€ í˜¸í™˜) ì„¤ì¹˜
- ì„œë²„ Java í™˜ê²½ì€ JDK 11
- í´ë¼ì´ì–¸íŠ¸ Java í™˜ê²½ì€ JDK 17

## ğŸ… Oracle Virtualbox ì„¤ì¹˜

[Downloads     â€“ Oracle VirtualBox](https://www.virtualbox.org/wiki/Downloads)

![image](https://github.com/user-attachments/assets/1e54d994-19b5-4321-85fe-1922a125a76a)


changeme

- ê³ ì • IP ì„¤ì¹˜í•˜ê¸°
- mtputty ì„¤ì¹˜í•˜ê¸°

## ğŸ… Kafka ì„¤ì¹˜í•˜ê¸°

```bash
wget https://packages.confluent.io/archive/7.1/confluent-community-7.1.2.tar.gz?_ga=2.257883202.813221415.1741676735-356653725.1741676735 --no-check-certificate
```

```bash
$ mv 'confluent-community-7.1.2.tar.gz?_ga=2.257883202.813221415.1741676735-356653725.1741676735' confluent-community.tar.gz
$ tar -xvf confluent-community.tar.gz
```

`.bashrc` í™˜ê²½ ë³€ìˆ˜ ë“±ë¡

```bash
export CONFLUENT_HOME=/home/vboxuser/confluent
export PATH=.:$PATH:$CONFLUENT_HOME/bin
```

zookeeper ê¸°ë™í•˜ê¸°

```bash
zookeeper-server-start $CONFLUENT_HOME/etc/kafka/zookeeper.properties
```

kafka ê¸°ë™í•˜ê¸°(ë°˜ë“œì‹œ zookeeperë¶€í„° ê¸°ë™)

```bash
kafka-server-start $CONFLUENT_HOME/etc/kafka/server.properties
```

<aside>
ğŸ’¡

shutdown ì‹œì—ëŠ” ë°˜ë“œì‹œ kafkaë¶€í„° ì§„í–‰í•´ì•¼ í•œë‹¤. 

ê¸°ë™ ìˆœì„œ : zookeeper â†’ kafka
ì¢…ë£Œ ìˆœì„œ : kafka â†’ zookeeper

</aside>

[`kafka-server-stop.sh`](http://kafka-server-stop.sh) ì˜ ë‚´ìš©

> ë‹¨ìˆœí•œ signal killì„ ìˆ˜í–‰í•¨
> 

```bash
#!/bin/bash
....
SIGNAL=${SIGNAL:-TERM}

OSNAME=$(uname -s)
if [[ "$OSNAME" == "OS/390" ]]; then
    if [ -z $JOBNAME ]; then
        JOBNAME="KAFKSTRT"
    fi
    PIDS=$(ps -A -o pid,jobname,comm | grep -i $JOBNAME | grep java | grep -v grep | awk '{print $1}')
elif [[ "$OSNAME" == "OS400" ]]; then
    PIDS=$(ps -Af | grep -i 'kafka\.Kafka' | grep java | grep -v grep | awk '{print $2}')
else
    PIDS=$(ps ax | grep ' kafka\.Kafka ' | grep java | grep -v grep | awk '{print $1}')
    PIDS_SUPPORT=$(ps ax | grep -i 'io\.confluent\.support\.metrics\.SupportedKafka' | grep java | grep -v grep | awk '{print $1}')
fi

if [ -z "$PIDS" ]; then
  # Normal Kafka is not running, but maybe we are running the support wrapper?
  if [ -z "${PIDS_SUPPORT}" ]; then
    echo "No kafka server to stop"
    exit 1
  else
    kill -s $SIGNAL $PIDS_SUPPORT
  fi
else
  kill -s $SIGNAL $PIDS
fi
```

## ğŸ… Kafka êµ¬ì„±í•˜ê¸°

topic ìƒì„±í•˜ê¸°

```bash
$ kafka-topics --bootstrap-server localhost:9092 --create --topic welcome-topic
Created topic welcome-topic.
```

### Zookeeper, Kafka ê¸°ë™ ì¢…ë£Œ ìŠ¤í¬ë¦½íŠ¸ ë§Œë“¤ê¸°

`zoo_start.sh`

```bash
$CONFLUENT_HOME/bin/zookeeper-server-start $CONFLUENT_HOME/etc/kafka/zookeeper.properties
```

`kafka_start.sh`

```bash
$CONFLUENT_HOME/bin/kafka-server-start $CONFLUENT_HOME/etc/kafka/server.properties
```

```bash
chmod +x *.sh

```

### server.properties

Kafkaì˜ [`server.properties`](http://server.properties) ëŠ” kafka brokerë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•œ êµ¬ì„± íŒŒì¼ì´ë‹¤. ì´ íŒŒì¼ì—ëŠ” ë¸Œë¡œì»¤ì˜ ë™ì‘ì„ ì œì–´í•˜ëŠ” ë‹¤ì–‘í•œ ì„¤ì •ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.

- ë¡œê·¸ ì„¤ì • `log.dirs` : ë¡œê·¸ ë°ì´í„°ê°€ ì €ì¥ëœ ë””ë ‰í„°ë¦¬ ê²½ë¡œë¥¼ ì§€ì •í•œë‹¤.
- Kafkaì—ì„œ ë¡œê·¸ë€, ë©”ì‹œì§€ ë°ì´í„°ë¥¼ ì˜ë¯¸í•œë‹¤. (ì‹œìŠ¤í…œ ë¡œê·¸ê°€ ì•„ë‹˜)
- ëª¨ë“  í† í”½ì˜ íŒŒí‹°ì…˜ ë°ì´í„°ê°€ ì´ ë””ë ‰í† ë¦¬ì— ì €ì¥ëœë‹¤.

```bash
############################# Log Basics #############################

# A comma separated list of directories under which to store log files
log.dirs=/home/vboxuser/data/kafka-logs
```

```bash
INFO Attempting recovery for all logs in /home/vboxuser/data/kafka-logs since no clean 
shutdown file was found (kafka.log.LogManager)
```

ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì €ì¥ëœë‹¤.

```bash
$ ll
total 20
drwxrwxr-x 2 vboxuser vboxuser 4096  3ì›” 11 17:40 ./
drwxrwxr-x 4 vboxuser vboxuser 4096  3ì›” 11 17:30 ../
-rw-rw-r-- 1 vboxuser vboxuser    0  3ì›” 11 17:40 cleaner-offset-checkpoint       
-rw-rw-r-- 1 vboxuser vboxuser    0  3ì›” 11 17:40 .lock
-rw-rw-r-- 1 vboxuser vboxuser    4  3ì›” 11 17:40 log-start-offset-checkpoint     
-rw-rw-r-- 1 vboxuser vboxuser   88  3ì›” 11 17:40 meta.properties
-rw-rw-r-- 1 vboxuser vboxuser    4  3ì›” 11 17:40 recovery-point-offset-checkpoint
-rw-rw-r-- 1 vboxuser vboxuser    0  3ì›” 11 17:40 replication-offset-checkpoint
```

### zookeeper.properties

[`zookeeper.properties`](http://zookeeper.properties) ëŠ” Zookeeperì˜ êµ¬ì„± íŒŒì¼ì´ë‹¤. ZookeeperëŠ” ë¶„ì‚° ì‹œìŠ¤í…œ ì¡°ì • ì„œë¹„ìŠ¤ë¡œ, Kafka í´ëŸ¬ìŠ¤í„°ì˜ ë¸Œë¡œì»¤ ìƒíƒœ ê´€ë¦¬, í† í”½ êµ¬ì„±, ì•¡ì„¸ìŠ¤ ì œì–´ ëª©ë¡(ACL), ì»¨ìŠˆë¨¸ ê·¸ë£¹ ì •ë³´ ë“±ì„ ì¶”ì í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.

> Kafka 2.8.0ë¶€í„° ZooKeeper ì˜ì¡´ì„±ì„ ì œê±°í•˜ê¸° ìœ„í•œ KRaft(Kafka Raft) ëª¨ë“œê°€ ë„ì…ë˜ì—ˆë‹¤ê³  í•œë‹¤. â†’ Kafka 4.0ë¶€í„°ëŠ” ZooKeeper ëª¨ë“œê°€ ë” ì´ìƒ ì§€ì›ë˜ì§€ ì•Šì„ ì˜ˆì •
> 
- ë°ì´í„° ì„¤ì • `dataDir` : zookeeperê°€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë””ë ‰í† ë¦¬ ê²½ë¡œ

```bash
# the directory where the snapshot is stored.
dataDir=/tmp/zookeeper
```

```bash
INFO Snapshotting: 0x0 to /home/vboxuser/data/zookeeper/version-2/snapshot.0 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
```

ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì €ì¥ëœë‹¤.

```bash
$ ll 
total 12
drwxrwxr-x 3 vboxuser vboxuser 4096  3ì›” 11 17:39 ./        
drwxrwxr-x 4 vboxuser vboxuser 4096  3ì›” 11 17:30 ../       
drwxrwxr-x 2 vboxuser vboxuser 4096  3ì›” 11 17:40 version-2/
```

## ğŸ… Topic ìƒì„±í•˜ê¸°

`welcome-topic` ì„ ìƒì„±í•œë‹¤.

```bash
$ kafka-topics --bootstrap-server localhost:9092 --create --topic welcome-to
pic
Created topic welcome-topic.
```

ê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì´ `log.Dirs` ê²½ë¡œì— topic ì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

`welcome-topic-0` ì—ì„œ 0ì€ íŒŒí‹°ì…˜ ë²ˆí˜¸ë¡œ, kafkaì—ì„œ ëª¨ë“  ë¡œê·¸ëŠ” íŒŒí‹°ì…˜ ë‹¨ìœ„ë¡œ ì €ì¥ëœë‹¤.

```bash
 $ ll
total 28
drwxrwxr-x 3 vboxuser vboxuser 4096  3ì›” 11 17:43 ./
drwxrwxr-x 4 vboxuser vboxuser 4096  3ì›” 11 17:30 ../
-rw-rw-r-- 1 vboxuser vboxuser    0  3ì›” 11 17:40 cleaner-offset-checkpoint       
-rw-rw-r-- 1 vboxuser vboxuser    0  3ì›” 11 17:40 .lock
-rw-rw-r-- 1 vboxuser vboxuser    4  3ì›” 11 17:43 log-start-offset-checkpoint     
-rw-rw-r-- 1 vboxuser vboxuser   88  3ì›” 11 17:40 meta.properties
-rw-rw-r-- 1 vboxuser vboxuser   22  3ì›” 11 17:43 recovery-point-offset-checkpoint
-rw-rw-r-- 1 vboxuser vboxuser   22  3ì›” 11 17:43 replication-offset-checkpoint   
drwxrwxr-x 2 vboxuser vboxuser 4096  3ì›” 11 17:43 **welcome-topic-0/**
```

## ğŸ… Topic ìƒì„± ë° ì •ë³´ í™•ì¸í•˜ê¸°

`$CONFLUENT_HOME/bin/kafka-topics` commandë¥¼ ì´ìš©í•œë‹¤.

| ì£¼ìš” ì¸ì | ì„¤ëª… |
| --- | --- |
| `--bootstrap-server` | Topicì„ ìƒì„±í•  Kafka Broker ì„œë²„ ì£¼ì†Œ: Port
`--bootstrap-server localhost:9092` |
| `--create` | `--topic` : ê¸°ìˆ ëœ topicëª…ìœ¼ë¡œ topic ì‹ ê·œ ìƒì„±
`--partitions` : Topicì˜ íŒŒí‹°ì…˜ ê°œìˆ˜
`--replication-factor` : replication ê°œìˆ˜ |
| `--list` | ë¸Œë¡œì»¤ì— ìˆëŠ” Topicë“¤ì˜ ë¦¬ìŠ¤íŠ¸ |
| `--describe` | `-- topic`: ê¸°ìˆ ëœ topicëª…ìœ¼ë¡œ ìƒì„¸ ì •ë³´ í‘œì‹œ |

`test_topic_01` ìƒì„±í•˜ê¸°

```bash
 kafka-topics --bootstrap-server localhost:9092 --create --topic test_topic01
```

topic ëª©ë¡ í™•ì¸í•˜ê¸°

```bash
kafka-topics --bootstrap-server localhost:9092 --list
```

partition 3ê°œë¥¼ ê°€ì§€ëŠ” topic ë§Œë“¤ì–´ë³´ê¸°

> ê°œìˆ˜ë¥¼ ì§€ì •í•˜ì§€ ì•Šì•˜ì„ ë•Œ default partition ê°œìˆ˜ëŠ” [`server.properties`](http://server.properties) ì˜ `num.partitions` ì— ì„¤ì •ëœë‹¤.
> 

```bash
 kafka-topics --bootstrap-server localhost:9092 --create --topic test_topic_02 --partitions 3
```

ê°œë³„ topicì˜ ìƒì„¸ ë‚´ìš© í™•ì¸í•˜ê¸°

```bash
$ kafka-topics --bootstrap-server localhost:9092 --describe --topic test_topic_02
Topic: test_topic_02    TopicId: 7WMF61LNR26xxA9KogSE_A PartitionCount: 3       ReplicationFactor: 1    Configs: 
segment.bytes=1073741824
        Topic: test_topic_02    Partition: 0    Leader: 0       Replicas: 0     Isr: 0
        Topic: test_topic_02    Partition: 1    Leader: 0       Replicas: 0     Isr: 0
        Topic: test_topic_02    Partition: 2    Leader: 0       Replicas: 0     Isr: 0
```

ë³µì œë³¸ ìˆ˜(replication-factor) ì§€ì •í•´ì„œ topic ìƒì„±í•˜ê¸°

ì—¬ê¸°ì„œ ì£¼ì˜! í˜„ì¬ ë‹¤ìŒê³¼ ê°™ì´ ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ìˆëŠ”ë°, Brokerê°€ 1ê°œì¸ ìƒí™©ì—ì„œ 2ê°œì˜ replication-factorë¥¼ êµ¬ì„±í•˜ë ¤ í–ˆê¸° ë•Œë¬¸ì´ë‹¤. 

```bash
$ kafka-topics --bootstrap-server localhost:9092 --create --topic test_topic_03 --partitions 3 -
-replication-factor 2
WARNING: Due to limitations in metric names, topics with a period ('.') or underscore ('_') could collide. To avoid issues it is best to use either, but not both.
Error while executing topic command : Replication factor: 2 larger than available brokers: 1.
[2025-03-12 11:02:52,581] ERROR org.apache.kafka.common.errors.InvalidReplicationFactorException: Replication factor: 2 larger than available brokers: 1.
 (kafka.admin.TopicCommand$)
```

topic ì‚­ì œí•˜ê¸°

> ì¦‰ê°ì ìœ¼ë¡œ ì‚¬ë¼ì§€ì§€ëŠ” ì•Šê³ , ì¡°ê¸ˆ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤.
> 

```bash
kafka-topics --bootstrap-server localhost:9092 --delete --topic test_topic_02
```

## ğŸ… kafka-console-producerì™€ kafka-console-consumerë¡œ Producerì™€ Consumer ì‹¤ìŠµ

ë‹¤ìŒê³¼ ê°™ì´ test í† í”½ì— í”„ë¡œë“€ì‹±í•´ë³´ì.

```bash
$ kafka-console-producer --bootstrap-server localhost:9092 --topic test-topic
>aaa
>bbb
>111
>ccc
>ddd
> ì•ˆë…•í•˜ì„¸ìš”
>eee
```

ê·¸ë¦¬ê³  ë‹¤ìŒê³¼ ê°™ì´ ì»¨ìŠˆë°í•´ì˜¬ ìˆ˜ ìˆë‹¤.

```bash
kafka-console-consumer --bootstrap-server localhost:9092 --topic test-topic
```

ê·¸ëŸ¬ë‚˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ë„, ì´ì „ì— í”„ë¡œë“€ì‹±í•œ ë©”ì‹œì§€ëŠ” ì»¨ìŠˆë°ë˜ì§€ ì•Šì„ ê²ƒì´ë‹¤.

ì—¬ê¸°ì„œ ì£¼ì˜í•´ì•¼ í• , ì•Œì•„ì•¼ í•  ê°œë…ì´ ìˆë‹¤.

### Consumerì˜ auto.offset.reset

- consumerê°€ topicì— **ì²˜ìŒ ì ‘ì†í•˜ì—¬** Messageë¥¼ ê°€ì ¸ì˜¬ ë•Œ ê°€ì¥ ì˜¤ë˜ëœ ì²˜ìŒ offsetë¶€í„°(earlist) ê°€ì ¸ì˜¬ ê²ƒì¸ì§€, ê°€ì¥ ìµœê·¼ì¸ ë§ˆì§€ë§‰ offset ë¶€í„° ê°€ì ¸ì˜¬ ê²ƒì¸ì§€ë¥¼ ì„¤ì •í•˜ëŠ” íŒŒë¼ë¯¸í„°
- `auto.offset.reset` = earlist : ì²˜ìŒ offset ë¶€í„° ì½ìŒ
- `auto.offset.reset` = latest : ë§ˆì§€ë§‰ offset ë¶€í„° ì½ìŒ

`kafka-console-consumer` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ë•Œ `--from-beginning` ì„ ì‚¬ìš©í•´ì•¼ë§Œ `auto.offset.reset` ì´ earlistë¡œ ì§€ì •ë¨

![image](https://github.com/user-attachments/assets/80f5200d-ad48-4efd-8646-64f796492e04)


ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì˜µì…˜ì„ ì‚¬ìš©í•´ì„œ ë‹¤ì‹œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´, ì´ì „ì˜ ë©”ì‹œì§€ë“¤ì„ ë°›ì•„ì˜¤ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

```bash
$ kafka-console-consumer --bootstrap-server localhost:9092 --topic test-topic 
--from-beginning
aaa
bbb        
111        
ccc        
ddd        
ï¿½ì•ˆë…•í•˜ì„¸ìš”
eee        
```

`--from-beginning` ì´ ì—†ë‹¤ë©´, ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œ ìˆœê°„(latest)ë¶€í„°ì˜ ë©”ì‹œì§€ë¥¼ ë°›ì•„ì˜¬ ì¤€ë¹„ë¥¼ í•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤. ì§€ê¸ˆê¹Œì§€ key ê°’ì´ ì—†ëŠ” ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” ì‹¤ìŠµì„ í•´ë³´ì•˜ë‹¤.

## ğŸ… Producerì˜ ê°ì²´ ì§ë ¬í™”(Serializer) ì „ì†¡ì˜ ì´í•´

ë©”ì‹œì§€ëŠ” í•­ìƒ **Byte Array í˜•ì‹ìœ¼ë¡œ ì „ì†¡**ëœë‹¤.

ì´ë ‡ê²Œ í–ˆì„ ë•Œ, í›¨ì”¬ ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ì„ ì˜ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , ì••ì¶•ì˜ íš¨ìœ¨ì„±ë„ ì¢‹ë‹¤.

- Serializaer
- Deserializer

![image](https://github.com/user-attachments/assets/38b73d02-1925-456f-8129-96a52a3e9065)


### ìë°” ê°ì²´(Object)ì˜ Serialization

ê°ì²´(Object)ë¥¼ ê°ì²´ì˜ ìœ í˜•, ë°ì´í„°ì˜ í¬ë§·, ì ìš© ì‹œìŠ¤í…œì— ìƒê´€ì—†ì´ ì´ë™/ì €ì¥/ë³µì›ì„ ììœ ë¡­ê²Œ í•˜ê¸° ìœ„í•´ì„œ ë°”ì´íŠ¸ ë°°ì—´(ë°”ì´íŠ¸ ìŠ¤íŠ¸ë¦¼) í˜•íƒœë¡œ ì €ì¥í•˜ëŠ” ê²ƒì´ë‹¤. ê°ì²´ëŠ” Serializationê³¼ Deserializationì„ í†µí•´ì„œ System to System ë˜ëŠ” ì„œë¡œ ë‹¤ë¥¸ ì €ì¥ ì˜ì—­ì— ì´ë™/ì €ì¥/ë³µì›ì„ ììœ ë¡­ê²Œ ìˆ˜í–‰í•œë‹¤.

![image](https://github.com/user-attachments/assets/b820c602-0190-4bca-9d66-60e511846e44)


### Serializationê³¼ Deserializationì„ í†µí•œ ë…¸ë“œê°„ì˜ ë°ì´í„° ì „ì†¡

Serializationì„ í†µí•´ì„œ ê°ì²´ê°€ ë°”ì´íŠ¸ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ë³€í™˜ë˜ì–´ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì†ì‰½ê²Œ ë°ì´í„°ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆìœ¼ë©°, Deserilizationì„ í†µí•´ì„œ ë°”ì´íŠ¸ ìŠ¤íŠ¸ë¦¼ì€ ë‹¤ì‹œ ì›ë³¸ ê°ì²´ë¡œ ë³€í™˜ë˜ì–´ ììœ ë¡œìš´ ê°ì²´ ë°ì´í„° ì´ë™ì„ ìˆ˜í–‰í•œë‹¤.

> TCP/IPì™€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œì€ ë°”ì´ë„ˆë¦¬ ë°ì´í„°(ë°”ì´íŠ¸)ë¥¼ ì£¼ê³ ë°›ëŠ” ê²ƒì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.
> 

![image](https://github.com/user-attachments/assets/6a8bd4e0-865a-421b-b675-0f5a3a0fd72c)


Producerì™€ Consumerì—ì„œ ì§ë ¬í™”/ì—­ì§ë ¬í™” ì ìš©

![image](https://github.com/user-attachments/assets/44d42969-d38e-42ef-b772-6c7dbec49dbc)


### Kafkaì—ì„œ ê¸°ë³¸ ì œê³µí•˜ëŠ” Serializer

- StringSerializer
- ShortSerializer
- IntegerSerializer
- LongSerializer
- DoubleSerializer
- BytesSerializer

![image](https://github.com/user-attachments/assets/b10de257-3e3b-4057-aeba-760241f37006)


## ğŸ… Key ê°’ì„ ê°€ì§€ì§€ ì•ŠëŠ” ë©”ì‹œì§€ ì „ì†¡

![image](https://github.com/user-attachments/assets/4a3a2700-0b3f-494b-b0c5-7743a406352a)


- ë©”ì‹œì§€ëŠ” Producerë¥¼ í†µí•´ ì „ì†¡ ì‹œ Partitionerë¥¼ í†µí•´ í† í”½ì˜ ì–´ë–¤ íŒŒí‹°ì…˜ìœ¼ë¡œ ì „ì†¡ë˜ì–´ì•¼ í•  ì§€ ë¯¸ë¦¬ ê²°ì •ì´ ë¨.
- key ê°’ì„ ê°€ì§€ì§€ ì•ŠëŠ” ê²½ìš° ë¼ìš´ë“œ ë¡œë¹ˆ(Round Robin), ìŠ¤í‹°í‚¤ íŒŒí‹°ì…˜(Sticky Partition) ë“±ì˜ íŒŒí‹°ì…˜ ì „ëµ ë“±ì´ ì„ íƒë˜ì–´ íŒŒí‹°ì…˜ ë³„ë¡œ ë©”ì‹œì§€ê°€ ì „ì†¡ë  ìˆ˜ ìˆìŒ
- Topicì´ ì—¬ëŸ¬ ê°œì˜ íŒŒí‹°ì…˜ì„ ê°€ì§ˆ ë•Œ ë©”ì‹œì§€ì˜ **ì „ì†¡ ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•Šì€** ì±„ë¡œ Consumerì—ì„œ ì½í˜€ì§ˆ ìˆ˜ ìˆìŒ

## ğŸ… Key ê°’ì„ ê°€ì§€ëŠ” ë©”ì‹œì§€ ì „ì†¡

![image](https://github.com/user-attachments/assets/d01e90db-857c-4c11-aa7e-dbc82dc37afc)

- ë©”ì‹œì§€ keyëŠ” ì—…ë¬´ ë¡œì§ì´ë‚˜ ë©”ì‹œì§€ Produce/Consume ì‹œ ë¶„ì‚° ì„±ëŠ¥ ì˜í–¥ì„ ê³ ë ¤í•˜ì—¬ ìƒì„±
- íŠ¹ì • key ê°’ì„ ê°€ì§€ëŠ” ë©”ì‹œì§€ëŠ” **íŠ¹ì • íŒŒí‹°ì…˜ìœ¼ë¡œ ê³ ì •ë˜ì–´ ì „ì†¡**ëœë‹¤.
    - í•´ì‹± ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•˜ì—¬, íŠ¹ì • key â†’ íŠ¹ì • partitionìœ¼ë¡œ ì „ì†¡ë˜ë„ë¡ í•œë‹¤.
- íŠ¹ì • key ê°’ì„ ê°€ì§€ëŠ” ë©”ì‹œì§€ëŠ” ë‹¨ì¼ íŒŒí‹°ì…˜ ë‚´ì—ì„œ ì „ì†¡ ìˆœì„œê°€ ë³´ì¥ë˜ì–´ Consumerì—ì„œ ì½í˜€ì§

> **KafkaëŠ” í•˜ë‚˜ì˜ íŒŒí‹°ì…˜ ë‚´ì—ì„œë§Œ ë©”ì‹œì§€ì˜ ìˆœì„œë¥¼ ë³´ì¥í•œë‹¤.**
> 

ì´ì œ ì½˜ì†” í”„ë¡œë“€ì„œë¥¼ í†µí•´ í† í”½ì—, key ê°’ì„ ê°€ì§€ëŠ” ë©”ì‹œì§€ë¥¼ ì „ì†¡í•´ë³´ì.

```bash
kafka-console-producer --bootstrap-server localhost:9092 --topic test-topic \
--property key.separator=: --property parse.key=true
```

ê·¸ë¦¬ê³  ë‹¤ìŒê³¼ ê°™ì´ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ì.

```bash
>01:aaa
>02:bbb
>01:ccc
>02:ddd
```

ê·¸ë¦¬ê³  ì½˜ì†” ì»¨ìŠˆë¨¸ë¥¼ í†µí•´ ë©”ì‹œì§€ë¥¼ í™•ì¸í•´ë³´ì.

```bash
kafka-console-consumer --bootstrap-server localhost:9092 --topic test-topic \
--property print.key=true --property print.value=true --from-beginning
```

```bash
01      aaa
02      bbb
01      ccc
02      ddd
```

## ğŸ… ì—¬ëŸ¬ ê°œì˜ íŒŒí‹°ì…˜ì„ ê°€ì§€ëŠ” ë©”ì‹œì§€ ì „ì†¡ ì‹¤ìŠµ

ìš°ì„  3ê°œì˜ íŒŒí‹°ì…˜ì„ ê°€ì§€ëŠ” í† í”½ì„ ë§Œë“¤ê³  ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë³´ì.

```bash
$ kafka-console-producer --bootstrap-server localhost:9092 --topic multipart-topic
>aaa
>bbb
>ccc
>ddd
>eee
>fff
>ggg
>bbb
>kkk
>rrr 
```

ì»¨ìŠˆë°í•  ë•Œ, `--property print.partition=true` ë¥¼ ì„¤ì •í•˜ë©´ íŒŒí‹°ì…˜ê³¼ í•¨ê»˜ í™•ì¸í•  ìˆ˜ ìˆë‹¤

```bash
$ kafka-console-consumer --bootstrap-server localhost:9092 --topic multipart-topic --from-beginning --property print.partition=true
Partition:2     ddd
Partition:2     bbb
Partition:0     bbb
Partition:0     ccc
Partition:0     fff
Partition:0     kkk
Partition:1     aaa
Partition:1     eee
Partition:1     ggg
Partition:1     rrr
```

íŒŒí‹°ì…˜ ë‹¨ìœ„ë¡œ ìˆœì„œê°€ ë³´ì¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

`console-consumer`ëŠ” ë°°ì¹˜ ë‹¨ìœ„ë¡œ ì½ì–´ì˜¬ ë•Œ, íŒŒí‹°ì…˜ì„ ë¬¶ìŒìœ¼ë¡œ ë¶ˆëŸ¬ì˜¨ë‹¤.

## ğŸ… Kafka Producerì˜ send() ë©”ì†Œë“œ í˜¸ì¶œ í”„ë¡œì„¸ìŠ¤

![image](https://github.com/user-attachments/assets/787a18da-3b3d-4012-9a23-c8857ddecd63)

## ğŸ… key ê°’ì„ ê°€ì§€ì§€ ì•ŠëŠ” ë©”ì‹œì§€ ì „ì†¡ ì‹œ íŒŒí‹°ì…˜ ë¶„ë°° ì „ëµ - Sticky íŒŒí‹°ì…”ë‹

> íŒŒí‹°ì…˜ ë¶„ë°° : Producerê°€ ë©”ì‹œì§€ë¥¼ ì–´ë–¤ íŒŒí‹°ì…˜ì— ê¸°ë¡í•  ì§€ ê²°ì •í•˜ëŠ” ê³¼ì •
> 
- Apache Kafka 2.4ë¶€í„° ìŠ¤í‹°í‚¤ íŒŒí‹°ì…”ë‹ (**Sticky Partitioner**) ì „ëµì´ ì±„íƒë¨.
- ë¼ìš´ë“œ ë¡œë¹ˆì˜ ì„±ëŠ¥ì„ ê°œì„ í•˜ê³ ì, íŠ¹ì • íŒŒí‹°ì…˜ìœ¼ë¡œ ì „ì†¡ë˜ëŠ” í•˜ë‚˜ì˜ ë°°ì¹˜ì— ë©”ì‹œì§€ë¥¼ ë¹ ë¥´ê²Œ ë¨¼ì € ì±„ì›Œì„œ ë³´ë‚´ëŠ” ë°©ì‹
- í•œ ë°°ì¹˜ê°€ ì±„ì›Œì§ˆ ë•Œê¹Œì§€ ê°™ì€ íŒŒí‹°ì…˜ì— ë©”ì‹œì§€ë¥¼ ë³´ë‚¸ í›„ ë‹¤ìŒ íŒŒí‹°ì…˜ìœ¼ë¡œ ì´ë™í•œë‹¤. ì´ëŠ” ë” ì ì€ ìš”ì²­ìœ¼ë¡œ ë” ë§ì€ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆê²Œ í•´ ì§€ì—° ì‹œê°„ì„ ì¤„ì´ê³  Brokerì˜ CPU ì‚¬ìš©ë¥ ì„ ê°ì†Œì‹œí‚¨ë‹¤.
- ë°°ì¹˜ë¥¼ ì±„ìš°ì§€ ëª»í•˜ê³  ì „ì†¡ì„ í•˜ê±°ë‚˜ ë°°ì¹˜ëŠ” ì±„ìš°ëŠ”ë° ì‹œê°„ì´ ë„ˆë¬´ ë§ì´ ê±¸ë¦¬ëŠ” ë¬¸ì œë¥¼ ê°œì„ 

![image](https://github.com/user-attachments/assets/72dd812f-bcc0-4460-bef2-91ffe260d866)

- [`linger.ms`](http://linger.ms) : í˜„ì¬ ë°°ì¹˜ê°€ ì „ì†¡ë˜ê¸° ì „ì— producerê°€ ì¶”ê°€ ë©”ì‹œì§€ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì‹œê°„
    - ì‹œê°„ ê¸°ë°˜ ë°°ì¹˜ ì™„ë£Œ ê¸°ì¤€ â€œì–¼ë§ˆë‚˜ ì˜¤ë˜ ê¸°ë‹¤ë¦¬ë©´ ì „ì†¡í•  ê²ƒì¸ê°€â€
- `batch.size` : ë™ì¼ íŒŒí‹°ì…˜ìœ¼ë¡œ ì „ì†¡ë˜ëŠ” ì—¬ëŸ¬ ë ˆì½”ë“œë¥¼ ë¬¶ì„ ë•Œ ì‚¬ìš©ë˜ëŠ” ê° ë°°ì¹˜ì˜ ìµœëŒ€ í¬ê¸°
    - í¬ê¸° ê¸°ë°˜ ë°°ì¹˜ ì™„ë£Œ ê¸°ì¤€ â€œì–¼ë§ˆë‚˜ ë§ì€ ë°ì´í„°ê°€ ëª¨ì´ë©´ ì „ì†¡í•  ê²ƒì¸ê°€â€

> ë‘ ê°€ì§€ ì¤‘ í•˜ë‚˜ë¼ë„ ì¡°ê±´ì´ ì¶©ì¡±ë˜ë©´ ì „ì†¡ëœë‹¤.
>
